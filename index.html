<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para ti ni√±a üíñ</title>
<style>
  html, body {
    margin: 0; padding: 0;
    width: 100%; height: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: radial-gradient(circle at top, #0d0d1a, #000010);
  }
  canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }
  .center {
    position: relative;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
  }
  .btn-open {
    padding: 12px 25px;
    border: none; border-radius: 30px;
    background: linear-gradient(45deg, #ff4da6, #ff0066);
    color: white; font-size: 16px; font-weight: bold; cursor: pointer;
    box-shadow: 0 0 20px rgba(255, 77, 166, 0.6);
    transition: 0.3s;
  }
  .btn-open:hover { transform: scale(1.1); }
  .modal {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 100;
    padding: 10px;
  }
  .card {
    background: #fff7e6;
    width: 85%; max-width: 400px;
    max-height: 90vh;
    padding: 25px;
    border-radius: 20px;
    text-align: center;
    transform: scale(0);
    transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    overflow-y: auto;
  }
  .card.show { transform: scale(1); }
  h2 { color: #ff0066; margin-top: 0; font-size: 1.5rem; }
  #text { color: #333; font-size: 1rem; line-height: 1.5; min-height: 80px; margin: 15px 0; }
  .btn-close {
    background: #333; color: white;
    border: none; padding: 10px 20px;
    border-radius: 20px; cursor: pointer;
    font-size: 0.95rem;
  }
  .heart-particle {
    position: absolute;
    pointer-events: none;
    z-index: 200;
    font-size: 20px;
  }
</style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="center">
  <button class="btn-open" onclick="openCard()">üíå Abrir Carta</button>
</div>

<div class="modal" id="modal">
  <div class="card" id="card">
    <h2>¬°TE QUIERO MUCHO!</h2>
    <div id="text"></div>
    <button class="btn-close" onclick="closeCard()">Cerrar</button>
  </div>
</div>

<audio id="music" loop>
  <source src="musica/luna.mp4" type="audio/mpeg">
</audio>

<script>
const music = document.getElementById("music");
const modal = document.getElementById("modal");
const card = document.getElementById("card");
const textElem = document.getElementById("text");
let heartInterval;

// Detecta pantalla peque√±a para menos part√≠culas
const isMobile = window.innerWidth < 600;

// Mensaje
const message = "HOY ES DOMINGO TAL VEZ NO TE PUEDA VER PERO TE QUIERO MUCHO NI√ëA üíñ";

// Abrir carta
function openCard() {
  modal.style.display = "flex";
  setTimeout(() => card.classList.add("show"), 50);

  // reproducir m√∫sica solo despu√©s de toque
  music.play().catch(() => {});

  typeWriter();

  // Explosi√≥n de corazones infinita
  heartInterval = setInterval(createHeartBatch, 400);
}

// Cerrar carta
function closeCard() {
  card.classList.remove("show");
  clearInterval(heartInterval);
  setTimeout(() => modal.style.display = "none", 500);
}

// Crear part√≠culas de corazones
function createHeartBatch() {
  const hearts = ["üíñ","üíó","üíò","‚ù§Ô∏è","‚ú®"];
  const count = isMobile ? 3 : 8;

  for(let i=0; i<count; i++) {
    const h = document.createElement("div");
    h.className = "heart-particle";
    h.innerHTML = hearts[Math.floor(Math.random()*hearts.length)];
    h.style.left = "50%"; h.style.top = "50%";
    document.body.appendChild(h);

    const angle = Math.random()*Math.PI*2;
    const dist = 100 + Math.random()*250;
    const x = Math.cos(angle)*dist;
    const y = Math.sin(angle)*dist;

    h.animate([
      { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
      { transform: `translate(calc(-50% + ${x}px), calc(-50% + ${y}px)) scale(1.5)`, opacity: 0 }
    ], { duration: 2000, easing: 'ease-out' }).onfinish = () => h.remove();
  }
}

// Efecto m√°quina de escribir
function typeWriter() {
  let i=0; textElem.innerHTML="";
  function typing() {
    if(i<message.length) {
      textElem.innerHTML += message.charAt(i);
      i++;
      setTimeout(typing, 50);
    }
  }
  typing();
}

// Estrellas infinitas
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");
let stars = [];

function initStars() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  stars = [];
  const starCount = isMobile ? 100 : 200;
  for(let i=0;i<starCount;i++) {
    stars.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      size: Math.random()*2,
      speed: Math.random()*0.5+0.1
    });
  }
}

function animateStars() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="white";
  stars.forEach(s=>{
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
    ctx.fill();
    s.y += s.speed;
    if(s.y > canvas.height) s.y = 0;
  });
  requestAnimationFrame(animateStars);
}

window.addEventListener("resize", () => { initStars(); });
initStars(); animateStars();
</script>

</body>
</html>